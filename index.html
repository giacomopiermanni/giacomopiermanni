<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Archivio fotografico â€” Giacomo Piermanni</title>
  <style>
    :root{ --fg:#111; --line:#eee; }
    html,body{margin:0;background:#fff;color:var(--fg);font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif}
    header{position:sticky;top:0;background:#fff;border-bottom:1px solid var(--line);
      display:flex;justify-content:space-between;align-items:center;padding:14px 16px;font-size:14px}
    header a{color:inherit;text-decoration:none} header a:hover{text-decoration:underline}

    .grid{
      max-width:1400px; margin:20px auto; padding:0 14px;
      display:grid; grid-template-columns:repeat(auto-fill,minmax(160px,1fr)); gap:10px;
    }
    .grid img{
      width:100%; height:150px; object-fit:cover; cursor:zoom-in; background:#f4f4f4;
      transition:transform .15s ease;
      content-visibility:auto; contain-intrinsic-size:300px 200px;
    }
    .grid img:hover{ transform:scale(1.03); }

    .lb{ position:fixed; inset:0; background:rgba(0,0,0,.95); display:none;
         align-items:center; justify-content:center; z-index:9999; }
    .lb.open{ display:flex; }
    .lb img{ max-width:96vw; max-height:94vh; }

    .nav{
      position:absolute; top:50%; transform:translateY(-50%);
      font-size:44px; color:#fff; cursor:pointer; user-select:none;
      padding:16px; background:rgba(0,0,0,.28);
      opacity:.6; transition:opacity .15s;
    }
    .nav:hover{ opacity:1; }
    .prev{ left:16px; } .next{ right:16px; }

    @media (hover:none){
      .nav{ display:none; }
      .tap-zone{ position:absolute; top:0; bottom:0; width:28vw; z-index:10000; }
      .tap-left{ left:0; } .tap-right{ right:0; }
    }
  </style>
</head>
<body>
  <header>
    <div>Archivio fotografico</div>
    <div><a href="mailto:giacomopiermanni@gmail.com">giacomopiermanni@gmail.com</a></div>
  </header>

  <main class="grid" id="grid">
    <!-- le tue immagini -->
  </main>

  <div class="lb" id="lb" aria-modal="true" role="dialog">
    <span class="nav prev" id="prev" aria-label="Foto precedente">&#10094;</span>
    <img id="lbImg" alt="">
    <span class="nav next" id="next" aria-label="Foto successiva">&#10095;</span>
    <div class="tap-zone tap-left" id="tapLeft" aria-hidden="true"></div>
    <div class="tap-zone tap-right" id="tapRight" aria-hidden="true"></div>
  </div>

  <script>
    document.querySelectorAll('#grid img').forEach(im => {
      im.loading = 'lazy'; im.decoding = 'async';
      im.addEventListener('click', () => openLB(im));
    });

    const thumbs = Array.from(document.querySelectorAll('#grid img'));
    const lb = document.getElementById('lb');
    const lbImg = document.getElementById('lbImg');
    const nextBtn = document.getElementById('next');
    const prevBtn = document.getElementById('prev');
    const tapLeft = document.getElementById('tapLeft');
    const tapRight = document.getElementById('tapRight');
    let i = -1;

    function openLB(el){
      i = thumbs.indexOf(el); lbImg.src = el.src;
      lb.classList.add('open'); document.body.style.overflow='hidden';
    }
    function closeLB(){ lb.classList.remove('open'); document.body.style.overflow=''; lbImg.src=''; }
    function next(){ if(!thumbs.length) return; i=(i+1)%thumbs.length; lbImg.src=thumbs[i].src; }
    function prev(){ if(!thumbs.length) return; i=(i-1+thumbs.length)%thumbs.length; lbImg.src=thumbs[i].src; }

    tapLeft.onclick=prev; tapRight.onclick=next;
    nextBtn.onclick=next; prevBtn.onclick=prev;

    lb.addEventListener('click', e => { if(e.target===lb) closeLB(); });
    document.addEventListener('keydown', e => {
      if(!lb.classList.contains('open')) return;
      if(e.key==='Escape') closeLB();
      if(e.key==='ArrowRight') next();
      if(e.key==='ArrowLeft') prev();
    });

    let touchX=null,touchY=null;
    lb.addEventListener('touchstart', e=>{
      if(!lb.classList.contains('open')) return;
      const t=e.changedTouches[0]; touchX=t.clientX; touchY=t.clientY;
    },{passive:true});
    lb.addEventListener('touchend', e=>{
      if(touchX===null) return;
      const t=e.changedTouches[0]; const dx=t.clientX-touchX,dy=t.clientY-touchY;
      if(Math.abs(dx)>40 && Math.abs(dy)<60){ dx<0?next():prev(); }
      touchX=touchY=null;
    },{passive:true});
  </script>
</body>
</html>
